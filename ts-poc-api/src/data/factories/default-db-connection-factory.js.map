{"version":3,"file":"default-db-connection-factory.js","sourceRoot":"","sources":["default-db-connection-factory.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,gDAAqF;AACrF,oDAA6D;AAG7D,MAAa,0BAA0B;IAKtB,MAAM;;YAEf,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAC9B;gBACI,IAAI,QAAQ,GAAG,+BAAoB,CAAC,SAAS,CAAW,UAAU,CAAC,CAAC;gBACpE,IAAI,CAAC,oBAAoB,GAAG,IAAI,kCAAyB,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,EAC7F,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;aAChE;YAED,OAAO,MAAM,IAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,CAAC;QACpD,CAAC;KAAA;IAGY,OAAO;;YAEhB,IAAI,IAAI,CAAC,oBAAoB,EAC7B;gBACI,IAAI,mBAAmB,GAAG,IAAI,CAAC,oBAAoB,CAAC;gBACpD,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;gBACjC,MAAM,mBAAmB,CAAC,OAAO,EAAE,CAAC;aACvC;QACL,CAAC;KAAA;CACJ;AA3BD,gEA2BC","sourcesContent":["import { DbConnectionFactory, KnexPgDbConnectionFactory } from \"@nivinjoseph/n-data\";\nimport { ConfigurationManager } from \"@nivinjoseph/n-config\";\n\n\nexport class DefaultDbConnectionFactory implements DbConnectionFactory\n{\n    private _dbConnectionFactory: DbConnectionFactory;\n\n\n    public async create(): Promise<object>\n    {\n        if (!this._dbConnectionFactory)\n        {\n            let dbConfig = ConfigurationManager.getConfig<DbConfig>(\"dbConfig\");\n            this._dbConnectionFactory = new KnexPgDbConnectionFactory(dbConfig.host, dbConfig.port.toString(),\n                dbConfig.database, dbConfig.username, dbConfig.password);\n        }\n\n        return await this._dbConnectionFactory.create();\n    }\n\n\n    public async dispose(): Promise<void>\n    {\n        if (this._dbConnectionFactory)\n        {\n            let dbConnectionFactory = this._dbConnectionFactory;\n            this._dbConnectionFactory = null;\n            await dbConnectionFactory.dispose();\n        }\n    }\n}\n\n\ninterface DbConfig\n{\n    host: string;\n    port: number;\n    database: string;\n    username: string;\n    password: string;\n}"]}