{"version":3,"file":"server.js","sourceRoot":"","sources":["server.ts"],"names":[],"mappings":";;AAAA,8CAA4C;AAC5C,oDAA6D;AAC7D,2DAAwD;AAExD,0DAAiD;AAEjD,mFAA8E;AAC9E,8CAAmD;AACnD,8EAAyE;AACzE,mGAA6F;AAC7F,gDAAiE;AACjE,gFAA2E;AAC3E,oDAA4D;AAG5D,MAAM,SAAS;IAEJ,OAAO,CAAC,QAAkB;QAE7B,mBAAK,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,cAAc,EAAE,CAAC,cAAc,EAAE,CAAC;QAE9D,QAAQ;aAEH,gBAAgB,CAAC,eAAe,EAAE,IAAI,8BAAmB,EAAE,CAAC;aAC5D,iBAAiB,CAAC,gBAAgB,EAAE,qCAAgB,CAAC;aACrD,iBAAiB,CAAC,aAAa,EAAE,yCAAkB,CAAC;aACpD,iBAAiB,CAAC,QAAQ,EAAE,qBAAa,CAAC;aAC1C,iBAAiB,CAAC,qBAAqB,EAAE,0DAA0B,CAAC;aACpE,iBAAiB,CAAC,IAAI,EAAE,iBAAQ,CAAC;aACjC,cAAc,CAAC,YAAY,EAAE,yBAAgB,CAAC,CAAC;IACxD,CAAC;CACJ;AAGD,MAAM,MAAM,GAAG,IAAI,cAAM,CAAC,+BAAoB,CAAC,SAAS,CAAS,MAAM,CAAC,CAAC;KACpE,YAAY,CAAC,IAAI,SAAS,EAAE,CAAC;KAC7B,mBAAmB,CAAC,GAAG,yBAAW,CAAC;KACnC,wBAAwB,CAAC,2CAAmB,CAAC;KAC7C,UAAU,EAAE,CAAC;AAElB,MAAM,CAAC,SAAS,EAAE,CAAC","sourcesContent":["import { WebApp } from \"@nivinjoseph/n-web\";\nimport { ConfigurationManager } from \"@nivinjoseph/n-config\";\nimport { controllers } from \"./controllers/controllers\";\nimport { ComponentInstaller, Registry } from \"@nivinjoseph/n-ject\";\nimport { given } from \"@nivinjoseph/n-defensive\";\n// import { InMemoryTodoRepository } from \"../data/repositories/in-memory-todo-repository\";\nimport { DefaultTodoFactory } from \"../domain/factories/default-todo-factory\";\nimport { ConsoleLogger } from \"@nivinjoseph/n-log\";\nimport { AppExceptionHandler } from \"./exceptions/app-exception-handler\";\nimport { DefaultDbConnectionFactory } from \"../data/factories/default-db-connection-factory\";\nimport { KnexPgDb, KnexPgUnitOfWork } from \"@nivinjoseph/n-data\";\nimport { DbTodoRepository } from \"../data/repositories/db-todo-repository\";\nimport { SystemDomainContext } from \"@nivinjoseph/n-domain\";\n\n\nclass Installer implements ComponentInstaller\n{\n    public install(registry: Registry): void\n    {\n        given(registry, \"registry\").ensureHasValue().ensureIsObject();\n        \n        registry\n            // .registerSingleton(\"TodoRepository\", InMemoryTodoRepository)\n            .registerInstance(\"DomainContext\", new SystemDomainContext())\n            .registerSingleton(\"TodoRepository\", DbTodoRepository)\n            .registerSingleton(\"TodoFactory\", DefaultTodoFactory)\n            .registerSingleton(\"Logger\", ConsoleLogger)\n            .registerSingleton(\"DbConnectionFactory\", DefaultDbConnectionFactory)\n            .registerSingleton(\"Db\", KnexPgDb)\n            .registerScoped(\"UnitOfWork\", KnexPgUnitOfWork);\n    }\n}\n\n\nconst server = new WebApp(ConfigurationManager.getConfig<number>(\"PORT\"))\n    .useInstaller(new Installer())\n    .registerControllers(...controllers)\n    .registerExceptionHandler(AppExceptionHandler)\n    .enableCors();\n\nserver.bootstrap();"]}