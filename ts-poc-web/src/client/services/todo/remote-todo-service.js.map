{"version":3,"file":"remote-todo-service.js","sourceRoot":"","sources":["remote-todo-service.ts"],"names":[],"mappings":"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","sourcesContent":["import { TodoService } from \"./todo-service\";\nimport { Todo } from \"../../models/todo\";\nimport { ConfigurationManager } from \"@nivinjoseph/n-config\";\nimport * as Axios from \"axios\";\nimport { given } from \"@nivinjoseph/n-defensive\";\nimport \"@nivinjoseph/n-ext\";\nimport { inject } from \"@nivinjoseph/n-ject\";\nimport { DialogService } from \"@nivinjoseph/n-app\";\n\n\n@inject(\"DialogService\")\nexport class RemoteTodoService implements TodoService\n{\n    private readonly _dialogService: DialogService;\n    private readonly _api: Axios.AxiosInstance;\n    \n    \n    public constructor(dialogService: DialogService)\n    {\n        given(dialogService, \"dialogService\").ensureHasValue().ensureIsObject();\n        \n        this._dialogService = dialogService;\n        \n        let apiUrl = ConfigurationManager.getConfig<string>(\"apiUrl\").trim();\n        if (!apiUrl.endsWith(\"/\"))\n            apiUrl += \"/\";\n        \n        this._api = Axios.default.create({\n            timeout: 60000,\n            baseURL: apiUrl\n        });\n    }\n    \n    \n    public async getTodos(): Promise<ReadonlyArray<Todo>>\n    {\n        this._dialogService.showLoadingScreen();\n        try \n        {\n            const response = await this._api.get<ReadonlyArray<Todo>>(\"api/query/getAllTodos\");\n            return response.data.map(t =>\n            {\n                t.isDeleted = false;\n                return t;\n            });\n        }\n        catch (error)\n        {\n            this.showErrorMessage(error.response.status);\n            throw error;\n        }\n        finally\n        {\n            this._dialogService.hideLoadingScreen();\n        }\n    }\n    \n    public async getTodo(id: string): Promise<Todo>\n    {\n        given(id, \"id\").ensureHasValue().ensureIsString();\n        \n        this._dialogService.showLoadingScreen();\n        try \n        {\n            const response = await this._api.get(`api/query/getTodo/${id.trim().toLowerCase()}`);\n            const todo: Todo = response.data;\n            todo.isDeleted = false;\n            return todo;\n        }\n        catch (error)\n        {\n            this.showErrorMessage(error.response.status);\n            throw error;\n        }\n        finally\n        {\n            this._dialogService.hideLoadingScreen();\n        }        \n    }\n    \n    public async createTodo(title: string, description: string): Promise<Todo>\n    {\n        given(title, \"title\").ensureHasValue().ensureIsString();\n        given(description, \"description\").ensureIsString();\n        \n        const command = {\n            title: title.trim(),\n            description: description ? description.trim() : \"\"\n        };\n        \n        this._dialogService.showLoadingScreen();\n        try\n        {\n            const response = await this._api.post(\"api/command/createTodo\", command);\n            this._dialogService.showSuccessMessage(\"Successfully created Todo.\");\n            const todo: Todo = response.data;\n            todo.isDeleted = false;\n            return todo;\n        }\n        catch (error)\n        {\n            this.showErrorMessage(error.response.status);\n            throw error;\n        }\n        finally\n        {\n            this._dialogService.hideLoadingScreen();\n        }\n    }\n    \n    public async updateTodo(id: string, title: string, description: string): Promise<void>\n    {\n        given(id, \"id\").ensureHasValue().ensureIsString();\n        given(title, \"title\").ensureHasValue().ensureIsString();\n        given(description, \"description\").ensureIsString();\n        \n        const command = {\n            id: id.trim().toLowerCase(),\n            title: title.trim(),\n            description: description ? description.trim() : \"\"\n        };\n        \n        this._dialogService.showLoadingScreen();\n        try \n        {\n            // @ts-ignore\n            const response = await this._api.post(\"api/command/updateTodo\", command);\n            this._dialogService.showSuccessMessage(\"Successfully updated Todo.\");\n        }\n        catch (error)\n        {\n            this.showErrorMessage(error.response.status);\n            throw error;\n        }\n        finally\n        {\n            this._dialogService.hideLoadingScreen();\n        }\n    }\n    \n    public async markTodoAsCompleted(id: string): Promise<void>\n    {\n        given(id, \"id\").ensureHasValue().ensureIsString();\n        \n        const command = {\n            id: id.trim().toLowerCase()\n        };\n        \n        this._dialogService.showLoadingScreen();\n        try \n        {\n            // @ts-ignore\n            const response = await this._api.post(\"api/command/markTodoAsCompleted\", command);\n            this._dialogService.showSuccessMessage(\"Successfully marked Todo as complete.\");\n        }\n        catch (error)\n        {\n            this.showErrorMessage(error.response.status);\n            throw error;\n        }\n        finally\n        {\n            this._dialogService.hideLoadingScreen();\n        }\n    }\n    \n    public async deleteTodo(id: string): Promise<void>\n    {\n        given(id, \"id\").ensureHasValue().ensureIsString();\n        \n        const command = {\n            id: id.trim().toLowerCase()\n        };\n        \n        this._dialogService.showLoadingScreen();\n        try \n        {\n            // @ts-ignore\n            const response = await this._api.post(\"api/command/deleteTodo\", command);\n            this._dialogService.showSuccessMessage(\"Successfully deleted Todo.\");\n        }\n        catch (error)\n        {\n            this.showErrorMessage(error.response.status);\n            throw error;\n        }\n        finally\n        {\n            this._dialogService.hideLoadingScreen();\n        }\n    }\n    \n    \n    private showErrorMessage(status: number): void\n    {\n        this._dialogService.showErrorMessage(`There was an error while processing your request. Code ${status}.`);\n    }\n}"]}